# 版本控制

维基百科 

- 版本控制的英文是Version control
- 是维护工程蓝图的标准作法
  - 能追踪工程蓝图从诞生一直到定案的过程
- 版本控制也是一种软件工程技巧
  - 借此能在软件开发的过程中
  - 确保由不同人所编辑的同一程序文件都得到同步

- 简单来说，版本控制在软件开发中
  - 可以帮助程序员进行代码的**追踪、维护、控制**等等一系列的操作

# 版本控制的功能

对于我们日常开发，我们常常面临如下一些问题，通过版本控制可以很好的解决

- 不同版本的存储管理
  - 一个项目会不断进行版本的迭代
    - 来修改之前的一些问题
    - 增加新的功能 , 需求
    - 甚至包括项目的重构
- 重大版本的备份维护
  - 对于很多重大的版本
    - 我们会进行备份管理
- 恢复之前的项目版本
  - 当我们开发过程中发生一些严重的问题时
  - 想要恢复之前的操作或者回到之前某个版本
- 记录项目的点点滴滴
  - 如果我们每一个功能的修改、bug的修复
  - 新的需求更改都需要记录下来
  - 版本控制可以很好的解决
- 多人开发的代码合并
  - 项目中通常都是多人开发
    - 将多人代码进行合并
  - 并且在出现冲突时更好的进行处理

# Git（Linus的作品）

- 早期的时候，Linux社区使用的是BitKeeper来进行版本控制；
- 但是因为一些原因，BitKeeper想要收回对Linux社区的免费授权；
- 于是Linus用了大概一周的时间，开发了Git用来取代BitKeeper；
- Linus完成了Git的核心设计，在之后Linus功成身退，将Git交由另外一个Git的主要贡献者Junio C Hamano来维护



# 集中式版本控制

- CVS和SVN都是是属于集中式版本控制系统

  - Centralized Version Control Systems，简称 CVCS

- 主要特点

- 单一的集中管理的服务器，保存所有文件的修订版本

- 协同开发人员通过客户端连接到这台服务器

  - 取出最新的文件或者提交更新

- 这种做法带来了许多好处

  - 特别是相较于老式的本地管理来说
    - 每个人都可以在一定程度上
      - 看到项目中的其他人正在做些什么

- 但是集中式版本控制也有一个核心的问题

  - 中央服务器不能出现故障

  如果宕机一小时，那么在这一小时内，谁都无法提

  交更新，也就无法协同工作

  如果中心数据库所在的磁盘发生损坏，又没有做恰

  当备份，毫无疑问你将丢失所有数据

# 分布式版本控制

- Git是属于分布式版本控制系统
  - Distributed Version Control System，简称 DVCS
- 客户端**并不只提取**最新版本的文件快照
  - **而是把代码仓库完整地镜像(复制)下来**
  - 包括完整的历史记录
- 这么一来，任何一处协同工作用的服务器发生故障
  - 事后都可以用**任何一个镜像出来的本地仓**库恢复
- 因为每一次的克隆操作
  - 实际上都是一次对代码仓库的完整备份
- ![image-20231127114247274](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231127114247274.png)



# Git中命令行Bash – CMD – GUI区别

- **Bash**是Unix shell 的一种

  - Linux 与 Mac OS X 都将它作为默认 shell

  -  Git Bash 就是一个 shell
    - 是 Windows 下的命令行工具
    - 可以执行 Linux 命令

  - Git Bash 是基于 CMD 的
    - 在 CMD 的基础上增添一些新的命令与功能

- **Git CMD**
  - 命令行提示符（CMD）是 Windows 操作系统上的命令行解释程序
  - 当你在 Windows 上安装 git 并且习惯使用命令行时
    - 可以使用 cmd 来运行 git 命令
- **Git GUI**
  - 基本上针对那些不喜欢黑屏（即命令行）编码的人
  - 它提供了一个图形用户界面来运行 git 命令

# Git的配置分类

- 每台计算机上只需要配置一次，程序升级时会保留配置信息
  - 你可以在任何时候再次通过运行命令来修改它们
- Git 自带一个 git config 的工具来帮助设置控制 Git 外观和行为的配置变量
  - /etc/gitconfig 文件
    - 包含系统上每一个用户及他们仓库的通用配置
      - 如果在执行 git config 时带上 --system 选项
        - 那么它就会读写该文件中的配置变量
      - 由于它是系统配置文件
        - 因此你需要管理员或超级用户权限来修改它
          - 开发中通常不修改
  -  ~/.gitconfig 或 C/用户/coderli/.gitconfig 文件
    - 只针对当前用户
    - 可以传递 --global 选项让 Git 读写此文件
    - 这会对你系统上 所有 的仓库生效
  - 当前使用仓库的 Git 目录中的 config 文件（即 .git/config）
    - 针对该仓库
    - 你可以传递 --local 选项让 Git 强制读写此文件
    - 虽然默认情况下用的就是它

**设置用户名和邮件地址**

- 因为每一个 Git 提交都会使用这些信息
  - 它们会写入到你的每一次提交中，不可更改
- 如果使用了 --global 选项，那么该命令只需要运行一次
  - 因为之后无论你在该系统上做任何事情
  - Git 都会使用那些信息
- 检测当前的配置信息：git config --list

## Git的别名（alias）

- **Git 并不会在你输入部分命令时自动推断出你想要的命令**
- 如果不想每次都输入完整的 Git 命令
  - 可以通过 git config 文件来轻松地为每一个命令设置一个别名
- 设置别名
- ![image-20231127131547298](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231127131547298.png)



# 获取Git仓库 – git init/git clone

- 我们需要一个Git来管理源代码，那么我们本地也需要有一个Git仓库
- 通常有两种获取 Git 项目仓库的方式
  - 方式一：初始化一个Git仓库
    - 并且可以**将当前项目的文件都添加到Git仓库**中
    - 目前很多的脚手架在创建项目时都会**默认创建一个Git仓库**
  - 方式二：从其它服务器克隆一个已存在的 Git 仓库
    - 第一天到公司通常我们需要做这个操作
    - 克隆 : clone
- **方式一：初始化Git仓库**
  - 该命令将创建一个名为 .git 的子目录
  - 这个子目录含有你初始化的 Git 仓库中所有的必须文件
  - 这些文件是 Git 仓库的核心
  - 但是，在这个时候，我们仅仅是做了一个初始化的操作
    - 你的项目里的文件还没有被跟踪
- **方式二：从Git远程仓库**
  - git clone https://github.com/coderwhy/hy-react-web-music.git

# 文件的状态划分

- 现在我们的电脑上已经有一个Git仓库
  - 在实际开发中, 需要将某些文件交由这个Git仓库来管理
  - 并且我们之后会修改文件的内容
    - 当达成某一个目标时 , 想要记录下来这次操作
      - 就会将它提交到仓库中
- 需要对文件来划分不同的状态
  - 以确定这个文件是否已经归于Git仓库的管理
- 未跟踪
  - 默认情况下, Git仓库下的文件也没有添加到Git仓库管理中
    - 我们需要通过add命令来操作
  - Untracked files : 未跟踪
- 已跟踪
  - 添加到Git仓库管理的文件处于已跟踪状态
    - Git可以对其进行各种跟踪管理
- 已跟踪的文件又可以细分为状态划分
  - staged
    - 暂缓 / 暂存区中的文件状态
    - 暂时性存储
  - Unmodified
    - Commit命令 , 可以将staged中文件提交到Git仓库中
  - Modified
    - 修改了某个文件后 , 会处于Modified状态
      - 已修改状态
      - 进入修改状态 , 需要再进入暂缓状态, 在进入Unmodified状态

在工作时，可以选择性地将这些修改过的文件放入暂存区

然后提交所有已暂存的修改，如此反复

# 检测文件的状态

- 我们在有Git仓库的目录下新建一个文件
  - 可以查看文件的状态
- 命令
  - git status
- Untracked files : 未跟踪的文件
  - 未跟踪的文件意味着Git在之前的提交中没有这些文件
  - Git不会自动将之纳入跟踪范围
- git status -s 可以更加简洁的查看状态信息



# 文件添加到暂存区

- 跟踪创建的新文件的命令
  - git add aaa.js
  - 使用命令 git add 开始跟踪一个文件
- 跟踪修改的文件命令
  - 如果我们已经跟踪了某一个文件
    - 这个时候修改了文件也需要**重新添加到暂存区**中
- 通过 git add . 将所有的文件添加到暂存区中

# 文件更新提交

- 现在的暂存区已经准备就绪，可以提交了
  -  每次准备提交前，可以先用 git status 看下
    - 你所需要的文件是不是都已暂存起来了
- 再运行提交命令 **git commit**
  - 可以在 commit 命令后添加 -m 选项
    - 将**提交信息**与命令放在同一行
  - git commit –m  "提交信息"
- 如果我们修改文件的使用add操作
  - 在加上commit的操作有点繁琐
    - 那么可以将两个命令结合来使用
  - git commit -a -m "提交信息"

# git忽略文件

- 一般我们总会有些文件无需纳入 Git 的管理, 也不希望它们总出现在未跟踪文件列表。
  - 通常都是些自动生成的文件，比如日志文件，或者编译过程中创建的临时文件等
  - 我们可以**创建一个名为 .gitignore 的文件**，列出要忽略的文件的模式
- 在实际开发中，这个文件通常不需要手动创建
  - 在必须的时候**添加自己的忽略内容即可**
- **比如创建的Vue项目自动创建的忽略文件：**
  - 包括一些不需要提交的文件、文件夹
  - 包括本地环境变量文件
  - 包括一些日志文件
  - 包括一些编辑器自动生成的文件
