## 从微信中进入小程序如何识别同一个小程序用户身边

- 在微信中进入小程序
  - 登录时
  - 微信自己的接口会返回一个openID
  - 这个openID就是记录微信用户的
    - 每一个用户都拥有的一个openID
  - 作用 : 有这个openID时, 就不需要在重新登录了, 直接静默登录
    - 这个openID会返回到后端服务器, 不会在前端展示





- 所以当用户登录时, 我们需要使用wx.login调用
  - 会返回一个code
  - 将这个code传递给后端
  - **后端拿到这个code + appid + appsecret**
    - 就可以**去微信接口请求openID**
      - 然后返回openID
  - 通过**微信接口返回到的openID**
    - **自定义登录状态 (token) 和openID相关联**
    -  识别是否是同一个用户了 :
      - 识别成功
    - **给前端返回一个自定义登录状态 (token)**
  - 我们就可以判断自定义登录状态 (token)
  - 给用户进入登录
    - **将这个自定义登录状态 (token)存储在storage中**
  - 之后发生业务网络请求时携带自定义登录状态 (token)发送给后端
    - 通过自定义登录状态 (token)
      - 查询对应的openID 
    - 后端在返回openID对应的业务数据
- openID还有一个作用时
  - 记录用户之前在小程序做的一些操作: 比如收藏评论了
  - 当用户再次登录时, 即可通过openID找到在服务器中的某些操作了

# unionid

- unionid用于在微信不同产品之间想用识别用户是否同一个用户时所用到的标识符

