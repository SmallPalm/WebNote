### **命令模式（Command Pattern）**

命令模式是一种行为型设计模式，它将**请求**封装成一个对象，从而使你可以用不同的请求对客户端进行参数化，以及支持请求的队列、日志和撤销操作等功能。

### **核心思想**

命令模式的核心是**将“行为请求者”与“行为执行者”解耦**，让两者通过命令对象进行交互。

- 客户端不会直接调用执行者的具体方法，而是通过命令对象发起请求。
- 命令对象包含了**请求的所有信息**，包括接收者和操作。

------

### **结构**

命令模式包含以下主要角色：

1. **Command（命令接口）**
   - 定义执行命令的接口，一般包含一个`execute()`方法。
2. **ConcreteCommand（具体命令类）**
   - 实现命令接口，负责调用接收者（Receiver）执行具体的请求操作。
3. **Receiver（接收者）**
   - 执行具体请求操作的类。
4. **Invoker（调用者/请求者）**
   - 保存命令对象并调用命令对象的`execute()`方法。
5. **Client（客户端）**
   - 创建具体命令对象，并设置命令的接收者，然后将命令对象传递给调用者。

------

### **优点**

1. **解耦请求者和接收者**：请求者只负责发送命令，接收者负责执行命令，两者不直接交互。
2. **可扩展性强**：新增命令很方便，无需修改现有代码。
3. **支持撤销和重做**：可以通过记录命令历史实现。
4. **支持请求队列**：可以将多个命令对象保存起来按顺序执行。

------

### **缺点**

1. **类的数量增加**：每个命令都需要一个具体命令类，会导致类数量增加。
2. **复杂性增加**：实现撤销、重做或队列操作时，可能需要额外的设计。

```js
// 命令接口
interface Command {
    void execute(); // 执行命令
}

// 接收者：电灯
class Light {
    public void turnOn() {
        System.out.println("The light is ON");
    }

    public void turnOff() {
        System.out.println("The light is OFF");
    }
}

// 具体命令：开灯命令
class TurnOnLightCommand implements Command {
    private Light light;

    public TurnOnLightCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.turnOn();
    }
}

// 具体命令：关灯命令
class TurnOffLightCommand implements Command {
    private Light light;

    public TurnOffLightCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.turnOff();
    }
}

// 调用者：遥控器
class RemoteControl {
    private Command command;

    public void setCommand(Command command) {
        this.command = command;
    }

    public void pressButton() {
        command.execute();
    }
}

// 客户端
public class Main {
    public static void main(String[] args) {
        Light light = new Light();

        Command turnOn = new TurnOnLightCommand(light);
        Command turnOff = new TurnOffLightCommand(light);

        RemoteControl remote = new RemoteControl();

        // 开灯
        remote.setCommand(turnOn);
        remote.pressButton();

        // 关灯
        remote.setCommand(turnOff);
        remote.pressButton();
    }
}
```

### **适用场景**

1. **需要解耦调用者和接收者**：比如遥控器与家电设备、菜单项与执行操作等。
2. **需要支持撤销/重做功能**：比如文本编辑器中的撤销、重做操作。
3. **需要支持操作的记录**：如事务处理、日志记录等。
4. **需要支持命令队列**：如任务调度系统。