# 一. uni-app中的页面传参

## 第一种方法

在uni-app中，页面传参通常通过 URL Query 传递。

如果是对象或数组，需要先将其转换为字符串

```js
// 跳转并传递参数 (对象或数组需要转换为字符串)
uni.navigateTo({
  url: `/pages/detail/detail?data=${encodeURIComponent(JSON.stringify({ name: '张三', age: 25 }))}`
});
```

#### 接收参数：

在目标页面的 `onLoad` 方法中接收参数，并将其解析回对象：

```js
// 接收参数并解析
onLoad(options) {
  const data = JSON.parse(decodeURIComponent(options.data));
  console.log(data); // { name: '张三', age: 25 }
}
```

## 第二种方法

使用eventChannel（页面间传参）

uni-app提供了 `eventChannel` 机制，可以在页面跳转时传递任意类型的数据，而无需通过 URL Query 编码。

```js
// 跳转并传递数据（对象或数组）
uni.navigateTo({
  url: '/pages/detail/detail',
  events: {
    // 在目标页面中可以通过 eventChannel.on() 来监听并接收数据
    acceptDataFromOpenedPage: function(data) {
      console.log(data); // 接收到的数据
    }
  },
  success: function(res) {
    // 通过 eventChannel 发送数据
    res.eventChannel.emit('acceptDataFromOpenedPage', { name: '王五', age: 35 });
  }
});
```

在目标页面接收参数：

```js
javascript复制代码onLoad() {
  // 获取 eventChannel
  const eventChannel = this.getOpenerEventChannel();
  // 监听传递的数据
  eventChannel.on('acceptDataFromOpenedPage', (data) => {
    console.log(data); // { name: '王五', age: 35 }
  });
}
```



# 二. Vue-router中的页面传参

## 第一种方法

- 在 `vue-router` 中，页面跳转传参可以通过 `query` 参数和 `params` 参数来实现。

#### 通过 `query` 传递对象：

```js
// 跳转并传递参数，通常使用 JSON 字符串来传递对象或数组
this.$router.push({
  path: '/detail',
  query: {
    data: JSON.stringify({ name: '李四', age: 30 })
  }
});
```

#### 目标页面接收参数：

```js
// 接收参数并解析
const data = JSON.parse(this.$route.query.data);
console.log(data); // { name: '李四', age: 30 }
```



## 第二种方法

#### 使用 `state` 传参

通过 `router.push` 或 `router.replace` 方法的 `state` 参数来传递对象或数组，这种方式不会将数据暴露在 URL 中，更安全。

跳转页面时传递参数：

```js
// 跳转并传递参数（使用 state）
this.$router.push({
  path: '/detail',
  state: { user: { name: '赵六', age: 40 } }
});
```

在目标页面中获取参数：

```js
// 获取 state 中的参数
const user = this.$router.history.current.state.user;
console.log(user); // { name: '赵六', age: 40 }
```



# 三. 微信小程序的页面传参

在微信小程序中，页面传参也通过 URL Query 传递，复杂数据类型需要先转换为字符串。

```js
// 跳转并传递参数
wx.navigateTo({
  url: `/pages/detail/detail?data=${encodeURIComponent(JSON.stringify([1, 2, 3]))}`
});
```

#### 接收参数：

在目标页面的 `onLoad` 中获取并解析参数：

```js
// 接收参数并解析
Page({
  onLoad(options) {
    const data = JSON.parse(decodeURIComponent(options.data));
    console.log(data); // [1, 2, 3]
  }
});
```

#### 使用 `globalData` 或 `Storage`

由于小程序的页面跳转参数限制，使用全局变量或存储方法来传递复杂数据也是一个不错的选择。

**方法 1：使用全局变量传参**

在 `app.js` 中定义全局变量：

```js
// app.js
App({
  globalData: {
    user: null
  }
});
```

跳转时设置全局变量：

```js
// 跳转前设置全局变量
const app = getApp();
app.globalData.user = { name: '孙七', age: 45 };
wx.navigateTo({
  url: '/pages/detail/detail'
});
```

在目标页面获取数据：

```js
// 获取全局变量数据
const app = getApp();
const user = app.globalData.user;
console.log(user); // { name: '孙七', age: 45 }
```

**方法 2：使用 `Storage` 传参**

将数据存储到本地缓存，然后在目标页面读取：

```js
// 设置数据到 Storage
wx.setStorageSync('user', { name: '周八', age: 50 });
wx.navigateTo({
  url: '/pages/detail/detail'
});
```

在目标页面读取数据：

```js
// 读取 Storage 中的数据
const user = wx.getStorageSync('user');
console.log(user); // { name: '周八', age: 50 }
```

### 优化的好处

1. **安全性**：避免将敏感数据暴露在 URL 中。
2. **传输数据类型丰富**：可以传递对象、数组等复杂数据类型，无需编码解码。
3. **解决数据长度限制**：避免 URL 过长导致的跳转失败问题。