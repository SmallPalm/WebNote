# template元素

需求

- v-if是一个指令, 所以必须将其添加到一个元素上
  - 但是如果我们希望切换的是多个元素
  - 此时我们渲染div , 但是我们并不希望div这种元素被渲染
  - 这个时候 , 我们可以选择使用template元素
- template元素可以当做 不可见的包裹元素
  - 并且在v-if上使用 
  - 但是最终template不会被浏览器渲染出来
  - 类似于小程序中的block
- 如果div或其他元素没有实际的意义
  - 那么可以使用template替换

# V-for

## 列表渲染

- 在真实开发中
  - 我们往往会从服务器拿到一组数据
  - 并且需要对其进行渲染
- 使用v-for来完成
  - 用于遍历一组数据

## 基本使用

v-for的基本格式是 item in  数据容器

- 数据容器通常是来自data或者prop
  - 也可以是其他方式
-  item是我们给每项元素起的一个别名
  - 这个别名可以自定来定义

遍历一个数组的时候会经常需要拿到数组的索引

- 需要索引
  - 可以使用格式： (item, index) in  数据容器
  -  注意顺序

## 支持的类型

- 支持遍历对象，并且支持有一二三个参数
  - "(value, key, index) in object"
  - 固定顺序
- 支持遍历数字
- 支持遍历可迭代对象

可以使用 template 元素来循环渲染一段包含多个元素的内容

- 遍历之后模板中只存在遍历出来的数据
  - 并没有遍历的痕迹

# v-for中的key是什么作用

- 使用v-for进行列表渲染时
  - 我们通常会给元素或者组件绑定一个key属性
- key属性的作用
  - key属性主要用在Vue的虚拟DOM算法
    - 在新旧nodes对比时辨识VNodes (虚拟DOM)
- 不使用key
  - Vue会使用一种最大限度减少动态元素
    - 并且尽可能的尝试**就地修改**/**复用相同类型元素**的算法
- 使用key
  - 它会基于key的变化重新排列元素顺序
    - 并且会移除/销毁key不存在的元素
    - 更好的性能优化

# 认识VNode

VNode的概念

- VNode的全称是Virtual Node
  - 就是虚拟节点
- 无论是组件还是元素
  - 它们最终在Vue中表示出来的都是一个个VNode
- VNode的本质是一个JavaScript的对象

- 在Vue中模板写法中并不是真正的HTML在浏览器中显示
  - 模板写法是先通过Vue解析成为VNode Tree
    - 在通过VNode Tree 解析成为 HTML
- ![image-20231206150635137](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231206150635137.png)
- ![image-20231206150700210](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231206150700210.png)

## 虚拟DOM的好处

- 当模板转成VNode时
  - 因为VNode本质上是一个JS对象
  - 那么它可以进行一个跨平台的作用
- 不仅仅是可以转换成真实DOM进行渲染在浏览器上
- 也可以渲染在移动端
- 桌面端的一些控件
- VR设备
- ![image-20231206152517469](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231206152517469.png)



在Vue中

- 对于**相同父元素的子元素节点**并不会重新渲染整个列表

么Vue中对于列表的更新究竟是如何操作

- Vue事实上会对于有key和没有key会调用两个不同的方法
- 有key，那么就使用 patchKeyedChildren方法
- 没有key，那么久使用 patchUnkeyedChildren方法

## 没有key的过程

![image-20231206153350326](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231206153350326.png)

## 有key的diff算法

![image-20231206153511260](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20231206153511260.png)



Vue在进行diff算法的时候，会尽量利用我们的key来进行优化操作

- 没有key的时候我们的效率是非常低效

- 在进行插入或者重置顺序的时候

  - 保持相同的key可以让diff算法更加的高效

  - # 直接查找 , 直接添加 , 无需重复
